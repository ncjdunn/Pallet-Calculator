
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>John's Better Pallet Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <script>if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js');}
document.addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    calculate();
  }
});
</script>

  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; background: #e0e0e0; color: #000; }
    label, select, input, button { display: block; width: 100%; margin-bottom: 15px; font-size: 16px; }
    .results { margin-top: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 8px; background: #fff; }
    button { background: #1e90ff; color: white; border: none; padding: 10px; border-radius: 6px; cursor: pointer; }
    button:hover { background: #0f78d1; }
  </style>
</head>
<body>
  <img src="logo.png" alt="Company Logo" style="display:block; margin: 0 auto 20px; max-height: 80px;">
  <h1 style="text-align:center;">John's Better Pallet Calculator</h1>

  <label>Liner Length (ft): <input type="number" id="length"></label>
  <label>Diameter (in): <input type="number" id="diameter"></label>
  <label>Gauge (mm): <input type="number" id="gauge"></label>
<button id="calculateBtn" onclick="calculate()">Calculate</button>
<label>Pallet Width (ft): 
    <select id="palletWidth">
      <option value="7">7 ft</option>
      <option value="8">8 ft</option>
    </select></div>
  </label>
  <label>Stack Direction:
    <select id="direction">
      <option value="longways">Longways</option>
      <option value="sideways">Sideways</option>
    </select></div>
  </label>
  <label>Manual Stack Count (optional):
    <select id="manualStacks">
      <option value="">Auto</option>
      <option value="1">1</option><option value="2">2</option><option value="3">3</option>
      <option value="4">4</option><option value="5">5</option><option value="6">6</option>
      <option value="7">7</option><option value="8">8</option><option value="9">9</option>
    </select></div>
  </label>
  <label>Manual Pallet (optional):
    <select id="manualPallet" style="display:none;">
      <option value="">Auto</option>
      <option value="4x4">4×4</option>
      <option value="4x7">4×7</option>
    </select></div>
  </label>

  <div class="results" id="results"></div>

  <script>
    const palletLengths = [4, 7, 9, 12, 15, 20, 24, 30, 34, 35, 36, 40, 42, 43, 45, 48, 53, 58, 60, 65, 70, 72];

    function calculate() {
      const length = parseFloat(document.getElementById('length').value);
      const diameter = parseFloat(document.getElementById('diameter').value);
      const gauge = parseFloat(document.getElementById('gauge').value);
      let palletWidth = parseInt(document.getElementById('palletWidth').value);
      const direction = document.getElementById('direction').value;
      const manualStacks = document.getElementById('manualStacks').value;
      const manualPallet = document.getElementById('manualPallet').value;
      const resultsDiv = document.getElementById('results');

      if (!length || !diameter || !gauge) {
        resultsDiv.innerHTML = '<p>Please fill in all fields.</p>';
        return;
      }

      let perFoldHeight = diameter >= 24 ? gauge * 0.2644 : gauge * 0.3175;
      if (diameter === 10 && gauge === 6) perFoldHeight = 1.905;
      if (diameter >= 24 && gauge === 12) perFoldHeight = 3.173;

      const stackWidth = (Math.PI * diameter) / 2;
      
      let stackLimit = Math.floor((palletWidth * 12) / stackWidth);

      // Apply real-world rules only for longways stacking on a 7ft wide pallet
      if (palletWidth === 7 && direction === "longways") {
        if (diameter >= 6 && diameter <= 6.5) stackLimit = 9;
        else if (diameter === 7) stackLimit = 8;
        else if (diameter > 7 && diameter <= 8) stackLimit = 7;
        else if (diameter > 8 && diameter <= 9.5) stackLimit = 6;
        else if (diameter >= 10 && diameter <= 11.5) stackLimit = 5;
        else if (diameter >= 12 && diameter <= 15) stackLimit = 4;
        else if (diameter >= 15.5 && diameter <= 20) stackLimit = 3;
        else if (diameter >= 20.5 && diameter <= 30) stackLimit = 2;
      }
      if (diameter >= 26.74 && diameter <= 30 && palletWidth === 7) stackLimit = 2;

      let palletList = palletLengths.slice();
      if (manualPallet === "4x4") {
        palletWidth = 4;
        palletList = [4];
      } else 
if (manualPallet === "4x7") {
  palletWidth = 4;
  palletList = [7];
  direction = "longways";
}


      const mStacks = manualStacks ? parseInt(manualStacks) : null;
      if (mStacks && mStacks > stackLimit) {
        resultsDiv.innerHTML = '<p style="color:red;"><strong>Too many stacks for pallet width.</strong></p>';
        return;
      }

      for (let palletLength of palletList) {
        const longEdge = direction === "longways" ? palletLength : palletWidth;
        const wideEdge = direction === "longways" ? palletWidth : palletLength;
        const stacks = mStacks || stackLimit;
        const foldsPerStack = Math.floor((length / stacks) / (2 * longEdge));
        const stackHeight = foldsPerStack * perFoldHeight;
        const totalHeight = stackHeight + 10;

        if (totalHeight <= 73.2) {
          const maxFootage = foldsPerStack * stacks * (2 * longEdge);
          const fullStackHeight = (maxFootage / (2 * longEdge * stacks)) * perFoldHeight + 10;

          resultsDiv.innerHTML = `
            <p><strong>Pallet Size:</strong> ${palletLength}×${palletWidth}</p>
            <p><strong>Stacks Across:</strong> ${stacks}</p>
            <p><strong>Folds per Stack:</strong> ${foldsPerStack}</p>
            <p><strong>Individual Stack Width:</strong> ${stackWidth.toFixed(2)}""</p>
<p><strong>Total Stack Width Used:</strong> ${(stackWidth * stacks).toFixed(2)}"</p>
<p><strong>Unused Space on Pallet:</strong> ${(palletWidth * 12 - stackWidth * stacks).toFixed(2)}"</p>
<p><strong>Stack Height:</strong> ${stackHeight.toFixed(2)}"</p>
            <p><strong>Total Height:</strong> ${totalHeight.toFixed(2)}"</p>
            
          `;
          return;
        }
      }

      resultsDiv.innerHTML = '<p style="color:red;"><strong>No pallet fits under 6.1 ft with these settings.</strong></p>';
    }
  
document.addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    calculate();
  }
});
</script>

</body>
</html>
